<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>hw</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="hw_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw_files/libs/quarto-html/quarto.js"></script>
<script src="hw_files/libs/quarto-html/popper.min.js"></script>
<script src="hw_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="time-series-analysis" class="level1">
<h1>Time Series Analysis</h1>
<p><strong>Authors</strong>: Zoe Zhou</p>
<p><a href="https://github.com/ZoeZhouJ/CMIP6_AWS">Link to Repository</a></p>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>The objective of this assignment is to analyze historical and projected climate data for a selected region using Python and outputs from two different CMIP6 climate models under various emission scenarios. Students will process monthly climate variables, such as surface air temperature, to create and plot regionally averaged time series. By fitting trend lines to these time series, the assignment aims to assess the magnitude and statistical significance of climate changes over both historical and future periods, culminating in an interpretation of the potential impacts on the region’s humans and ecosystems</p>
</section>
<section id="acknowledgement" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgement">Acknowledgement</h2>
<p>This analysis contains materials prepared by Samantha Stevenson for the course EDS 296. This course is part of the UCSB Masters in Environmental Data Science.</p>
<section id="access-data-through-amazon-web-services-cloud-server" class="level3">
<h3 class="anchored" data-anchor-id="access-data-through-amazon-web-services-cloud-server">1. Access data through Amazon Web Services cloud server</h3>
<ul>
<li>Locate monthly data for a historical simulation run with any two CMIP6 models</li>
<li>Variables to analyze: surface air temperature (tas) and sea surface temperature (tos)</li>
</ul>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> intake</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> s3fs</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Search catalog for models for source_id that shares one ensemble member</li>
</ul>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>catalog <span class="op">=</span> intake.open_esm_datastore(<span class="st">'https://cmip6-pds.s3.amazonaws.com/pangeo-cmip6.json'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all unique CMIP6 activities</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#catalog.df.activity_id.unique()</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Search through catalog, find all historical simulations and memeber id</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#res = catalog.search(activity_id="CMIP", experiment_id="historical")</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> catalog.search(activity_id<span class="op">=</span><span class="st">"CMIP"</span>, experiment_id<span class="op">=</span><span class="st">"historical"</span>, member_id<span class="op">=</span><span class="st">"r10i1p1f1"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>res_df <span class="op">=</span> res.df</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique model names in the set of search results</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> res_df.source_id.unique()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print list of model names</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['IPSL-CM6A-LR' 'GISS-E2-1-G' 'MIROC6' 'CanESM5' 'CESM2' 'GISS-E2-1-H'
 'MPI-ESM1-2-LR' 'MPI-ESM1-2-HR' 'INM-CM5-0' 'NorCPM1' 'EC-Earth3'
 'ACCESS-ESM1-5' 'EC-Earth3-Veg' 'MRI-ESM2-0']</code></pre>
</div>
</div>
<ul>
<li><p>Choose CanESM5 and CESM2</p></li>
<li><p>Both models have historical simulations with member_id = r20i1p2f1</p></li>
</ul>
</section>
</section>
<section id="canesm5-model-data" class="level2">
<h2 class="anchored" data-anchor-id="canesm5-model-data">CanESM5 model data</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify search terms to query catalog for CanESM5 data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># activity_id: which project do you want? CMIP = historical data, ScenarioMIP = future projections</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>activity_ids <span class="op">=</span> [<span class="st">'ScenarioMIP'</span>, <span class="st">'CMIP'</span>] </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source_id: which model do you want? </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>source_id <span class="op">=</span> [<span class="st">'CanESM5'</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment_id: what experimental configuration do you want? Here we want historical and the four main SSPs</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>experiment_ids <span class="op">=</span> [<span class="st">'historical'</span>, <span class="st">'ssp126'</span>, <span class="st">'ssp370'</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># member_id: which ensemble member do you want? Here we want r10i1p1f1</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>member_id <span class="op">=</span> <span class="st">'r20i1p2f1'</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_id: which part of the Earth system and time resolution do you want? Here we want monthly atmosphere data</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>table_id <span class="op">=</span> <span class="st">'Amon'</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># variable_id: which climate variable do you want? Here we want surface air temperature</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>variable_id <span class="op">=</span> [<span class="st">'tas'</span>, <span class="st">'pr'</span>] </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the CMIP6 data catalog, store as a variable</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>catalog <span class="op">=</span> intake.open_esm_datastore(<span class="st">'https://cmip6-pds.s3.amazonaws.com/pangeo-cmip6.json'</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Search through catalog, store results in "res" variable</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>CanESM5_res <span class="op">=</span> catalog.search(activity_id<span class="op">=</span>activity_ids, source_id<span class="op">=</span>source_id, experiment_id<span class="op">=</span>experiment_ids, </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                     member_id<span class="op">=</span>member_id, table_id<span class="op">=</span>table_id, variable_id<span class="op">=</span>variable_id)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data frame associated with results</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>display(CanESM5_res.df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activity_id</th>
      <th>institution_id</th>
      <th>source_id</th>
      <th>experiment_id</th>
      <th>member_id</th>
      <th>table_id</th>
      <th>variable_id</th>
      <th>grid_label</th>
      <th>zstore</th>
      <th>dcpp_init_year</th>
      <th>version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ScenarioMIP</td>
      <td>CCCma</td>
      <td>CanESM5</td>
      <td>ssp370</td>
      <td>r20i1p2f1</td>
      <td>Amon</td>
      <td>tas</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/CCCma/CanESM5...</td>
      <td>NaN</td>
      <td>20190429</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ScenarioMIP</td>
      <td>CCCma</td>
      <td>CanESM5</td>
      <td>ssp370</td>
      <td>r20i1p2f1</td>
      <td>Amon</td>
      <td>pr</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/CCCma/CanESM5...</td>
      <td>NaN</td>
      <td>20190429</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CMIP</td>
      <td>CCCma</td>
      <td>CanESM5</td>
      <td>historical</td>
      <td>r20i1p2f1</td>
      <td>Amon</td>
      <td>tas</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/CMIP/CCCma/CanESM5/histor...</td>
      <td>NaN</td>
      <td>20190429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CMIP</td>
      <td>CCCma</td>
      <td>CanESM5</td>
      <td>historical</td>
      <td>r20i1p2f1</td>
      <td>Amon</td>
      <td>pr</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/CMIP/CCCma/CanESM5/histor...</td>
      <td>NaN</td>
      <td>20190429</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ScenarioMIP</td>
      <td>CCCma</td>
      <td>CanESM5</td>
      <td>ssp126</td>
      <td>r20i1p2f1</td>
      <td>Amon</td>
      <td>tas</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/CCCma/CanESM5...</td>
      <td>NaN</td>
      <td>20190429</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ScenarioMIP</td>
      <td>CCCma</td>
      <td>CanESM5</td>
      <td>ssp126</td>
      <td>r20i1p2f1</td>
      <td>Amon</td>
      <td>pr</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/CCCma/CanESM5...</td>
      <td>NaN</td>
      <td>20190429</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Read in data and store as an xarray object Load in data from the historical simulation, as well as corresponding future projection information for two different future emissions scenarios, for each model.</li>
</ol>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in just the historical data file</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>can_pr_hist_data <span class="op">=</span> xr.open_zarr(CanESM5_res.df[<span class="st">'zstore'</span>][<span class="dv">3</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP126</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>can_pr_ssp126_data <span class="op">=</span> xr.open_zarr(CanESM5_res.df[<span class="st">'zstore'</span>][<span class="dv">5</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP370</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>can_pr_ssp370_data <span class="op">=</span> xr.open_zarr(CanESM5_res.df[<span class="st">'zstore'</span>][<span class="dv">1</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in just the historical data file</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>can_tas_hist_data <span class="op">=</span> xr.open_zarr(CanESM5_res.df[<span class="st">'zstore'</span>][<span class="dv">2</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP126</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>can_tas_ssp126_data <span class="op">=</span> xr.open_zarr(CanESM5_res.df[<span class="st">'zstore'</span>][<span class="dv">4</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP370</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>can_tas_ssp370_data <span class="op">=</span> xr.open_zarr(CanESM5_res.df[<span class="st">'zstore'</span>][<span class="dv">0</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cesm2-model-data" class="level2">
<h2 class="anchored" data-anchor-id="cesm2-model-data">CESM2 Model Data</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify search terms to query catalog for CanESM5 data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># activity_id: which project do you want? CMIP = historical data, ScenarioMIP = future projections</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>activity_ids <span class="op">=</span> [<span class="st">'ScenarioMIP'</span>, <span class="st">'CMIP'</span>] </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># source_id: which model do you want? </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>source_id <span class="op">=</span> [<span class="st">'CESM2'</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># experiment_id: what experimental configuration do you want? Here we want historical and the four main SSPs</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>experiment_ids <span class="op">=</span> [<span class="st">'historical'</span>, <span class="st">'ssp126'</span>, <span class="st">'ssp370'</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># member_id: which ensemble member do you want? Here we want r10i1p1f1</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>member_id <span class="op">=</span> <span class="st">'r10i1p1f1'</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_id: which part of the Earth system and time resolution do you want? Here we want monthly atmosphere data</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>table_id <span class="op">=</span> <span class="st">'Amon'</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># variable_id: which climate variable do you want? Here we want surface air temperature</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>variable_id <span class="op">=</span> [<span class="st">'tas'</span>, <span class="st">'pr'</span>] </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the CMIP6 data catalog, store as a variable</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#catalog = intake.open_esm_datastore('https://cmip6-pds.s3.amazonaws.com/pangeo-cmip6.json')</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Search through catalog, store results in "res" variable</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>CESM_res <span class="op">=</span> catalog.search(activity_id<span class="op">=</span>activity_ids, source_id<span class="op">=</span>source_id, experiment_id<span class="op">=</span>experiment_ids, </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                     member_id<span class="op">=</span>member_id, table_id<span class="op">=</span>table_id, variable_id<span class="op">=</span>variable_id)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data frame associated with results</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>display(CESM_res.df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>activity_id</th>
      <th>institution_id</th>
      <th>source_id</th>
      <th>experiment_id</th>
      <th>member_id</th>
      <th>table_id</th>
      <th>variable_id</th>
      <th>grid_label</th>
      <th>zstore</th>
      <th>dcpp_init_year</th>
      <th>version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CMIP</td>
      <td>NCAR</td>
      <td>CESM2</td>
      <td>historical</td>
      <td>r10i1p1f1</td>
      <td>Amon</td>
      <td>tas</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/CMIP/NCAR/CESM2/historica...</td>
      <td>NaN</td>
      <td>20190313</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CMIP</td>
      <td>NCAR</td>
      <td>CESM2</td>
      <td>historical</td>
      <td>r10i1p1f1</td>
      <td>Amon</td>
      <td>pr</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/CMIP/NCAR/CESM2/historica...</td>
      <td>NaN</td>
      <td>20200124</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ScenarioMIP</td>
      <td>NCAR</td>
      <td>CESM2</td>
      <td>ssp370</td>
      <td>r10i1p1f1</td>
      <td>Amon</td>
      <td>tas</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/NCAR/CESM2/ss...</td>
      <td>NaN</td>
      <td>20200528</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ScenarioMIP</td>
      <td>NCAR</td>
      <td>CESM2</td>
      <td>ssp370</td>
      <td>r10i1p1f1</td>
      <td>Amon</td>
      <td>pr</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/NCAR/CESM2/ss...</td>
      <td>NaN</td>
      <td>20200528</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ScenarioMIP</td>
      <td>NCAR</td>
      <td>CESM2</td>
      <td>ssp126</td>
      <td>r10i1p1f1</td>
      <td>Amon</td>
      <td>pr</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/NCAR/CESM2/ss...</td>
      <td>NaN</td>
      <td>20200528</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ScenarioMIP</td>
      <td>NCAR</td>
      <td>CESM2</td>
      <td>ssp126</td>
      <td>r10i1p1f1</td>
      <td>Amon</td>
      <td>tas</td>
      <td>gn</td>
      <td>s3://cmip6-pds/CMIP6/ScenarioMIP/NCAR/CESM2/ss...</td>
      <td>NaN</td>
      <td>20200528</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Read in data and store as an xarray object Load in data from the historical simulation, as well as corresponding future projection information for two different future emissions scenarios, for each model.</li>
</ol>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in just the historical data file</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>CESM_pr_hist_data <span class="op">=</span> xr.open_zarr(CESM_res.df[<span class="st">'zstore'</span>][<span class="dv">1</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP126</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>CESM_pr_ssp126_data <span class="op">=</span> xr.open_zarr(CESM_res.df[<span class="st">'zstore'</span>][<span class="dv">4</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP370</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>CESM_pr_ssp370_data <span class="op">=</span> xr.open_zarr(CESM_res.df[<span class="st">'zstore'</span>][<span class="dv">3</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in just the historical data file</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>CESM_tas_hist_data <span class="op">=</span> xr.open_zarr(CESM_res.df[<span class="st">'zstore'</span>][<span class="dv">0</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP126</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>CESM_tas_ssp126_data <span class="op">=</span> xr.open_zarr(CESM_res.df[<span class="st">'zstore'</span>][<span class="dv">5</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data for SSP370</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>CESM_tas_ssp370_data <span class="op">=</span> xr.open_zarr(CESM_res.df[<span class="st">'zstore'</span>][<span class="dv">2</span>], storage_options<span class="op">=</span>{<span class="st">'anon'</span>: <span class="va">True</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="surface-air-temp-time-series-plot" class="level3">
<h3 class="anchored" data-anchor-id="surface-air-temp-time-series-plot">2. Surface Air Temp Time Series Plot</h3>
<p>Read in the surface air temperature datasets from 1 and 2, and create annually averaged, area-weighted, regionally averaged time series for your region of interest. #### CANESM5 Model</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## tas Historical + SSP370</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>can_tas_370 <span class="op">=</span> xr.concat([can_tas_hist_data, can_tas_ssp370_data], dim<span class="op">=</span><span class="st">"time"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">## tas Historicl + SSP126</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>can_tas_126 <span class="op">=</span> xr.concat([can_tas_hist_data, can_tas_ssp126_data], dim<span class="op">=</span><span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cesm-model" class="level4">
<h4 class="anchored" data-anchor-id="cesm-model">CESM Model</h4>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## tas Historical + SSP370</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cesm_tas_370 <span class="op">=</span> xr.concat([CESM_tas_hist_data, CESM_tas_ssp370_data], dim<span class="op">=</span><span class="st">"time"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">## tas Historicl + SSP126</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>cesm_tas_126 <span class="op">=</span> xr.concat([CESM_tas_hist_data, CESM_tas_ssp126_data], dim<span class="op">=</span><span class="st">"time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the tas variable, store as xarray DataArray and convert units to Celsius</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>can_tas_370 <span class="op">=</span> can_tas_370.tas <span class="op">-</span> <span class="fl">273.15</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>can_tas_126 <span class="op">=</span> can_tas_126.tas <span class="op">-</span> <span class="fl">273.15</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>cesm_tas_370 <span class="op">=</span> cesm_tas_370.tas <span class="op">-</span> <span class="fl">273.15</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cesm_tas_126 <span class="op">=</span> cesm_tas_126.tas <span class="op">-</span> <span class="fl">273.15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time to datetime64 format</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> can_tas_126.time.astype(<span class="st">'datetime64[ns]'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time to datetime64 format</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> can_tas_370.time.astype(<span class="st">'datetime64[ns]'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time to datetime64 format</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> cesm_tas_126.time.astype(<span class="st">'datetime64[ns]'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time to datetime64 format</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> cesm_tas_370.time.astype(<span class="st">'datetime64[ns]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="weighted-average" class="level3">
<h3 class="anchored" data-anchor-id="weighted-average">3. Weighted Average</h3>
<p>Weighting grid cells by their area ensures that regional average climate plots accurately reflect the true climate of the region.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to generate area weights</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> weights(dat):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate weighting factor = cosine of latitude</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    coslat <span class="op">=</span> np.cos(np.deg2rad(dat.lat))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    weight_factor <span class="op">=</span> coslat <span class="op">/</span> coslat.mean(dim<span class="op">=</span><span class="st">'lat'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Weight all points by the weighting factor</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    computed_weight <span class="op">=</span> dat <span class="op">*</span> weight_factor</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the set of weights: this has dimension equal to that of the input data</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> computed_weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply function to weight the temp data </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cesm_tas_126 <span class="op">=</span> weights(cesm_tas_126)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>cesm_tas_370 <span class="op">=</span> weights(cesm_tas_370)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>can_tas_370 <span class="op">=</span> weights(can_tas_370)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>can_tas_126 <span class="op">=</span> weights(can_tas_126)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>can_tas_126</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray (time: 3012, lat: 64, lon: 128)&gt;
dask.array&lt;mul, shape=(3012, 64, 128), dtype=float64, chunksize=(1980, 64, 128), chunktype=numpy.ndarray&gt;
Coordinates:
    height   float64 2.0
  * lat      (lat) float64 -87.86 -85.1 -82.31 -79.53 ... 79.53 82.31 85.1 87.86
  * lon      (lon) float64 0.0 2.812 5.625 8.438 ... 348.8 351.6 354.4 357.2
  * time     (time) object 1850-01-16 12:00:00 ... 2100-12-16 12:00:00</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">time</span>: 3012</li><li><span class="xr-has-index">lat</span>: 64</li><li><span class="xr-has-index">lon</span>: 128</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-5b483c11-c0ab-43a8-83ce-35e864a9d01f" class="xr-array-in" type="checkbox" checked=""><label for="section-5b483c11-c0ab-43a8-83ce-35e864a9d01f" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>dask.array&lt;chunksize=(1980, 64, 128), meta=np.ndarray&gt;</span></div><div class="xr-array-data"><table>
    <tbody><tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 188.25 MiB </td>
                        <td> 123.75 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3012, 64, 128) </td>
                        <td> (1980, 64, 128) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 8 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="164" height="149" style="stroke:rgb(0,0,0);stroke-width:1">

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="10" y1="29" x2="80" y2="99" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="29" style="stroke-width:2"></line>
  <line x1="56" y1="46" x2="56" y2="75"></line>
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,99.96151336177923 10.0,29.373278067661577" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="43" y2="0" style="stroke-width:2"></line>
  <line x1="56" y1="46" x2="89" y2="46"></line>
  <line x1="80" y1="70" x2="114" y2="70" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2"></line>
  <line x1="43" y1="0" x2="114" y2="70" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 43.504509824833484,0.0 114.09274511895114,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="114" y2="70" style="stroke-width:2"></line>
  <line x1="80" y1="99" x2="114" y2="99" style="stroke-width:2"></line>

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2"></line>
  <line x1="114" y1="70" x2="114" y2="99" style="stroke-width:2"></line>

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 114.09274511895114,70.58823529411765 114.09274511895114,99.96151336177923 80.58823529411765,99.96151336177923" style="fill:#ECB172A0;stroke-width:0"></polygon>

  <!-- Text -->
  <text x="97.340490" y="119.961513" font-size="1.0rem" font-weight="100" text-anchor="middle">128</text>
  <text x="134.092745" y="85.274874" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,134.092745,85.274874)">64</text>
  <text x="35.294118" y="84.667396" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,84.667396)">3012</text>
</svg>
        </td>
    </tr>
</tbody></table></div></div></li><li class="xr-section-item"><input id="section-6423449c-784c-4b0a-98e5-4a290e65673c" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-6423449c-784c-4b0a-98e5-4a290e65673c" class="xr-section-summary">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>height</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.0</div><input id="attrs-de6732ad-a369-44b1-9b70-26240a6a33b5" class="xr-var-attrs-in" type="checkbox"><label for="attrs-de6732ad-a369-44b1-9b70-26240a6a33b5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7fc4948b-91f3-49b7-bcfa-4c3c6ae5c5e9" class="xr-var-data-in" type="checkbox"><label for="data-7fc4948b-91f3-49b7-bcfa-4c3c6ae5c5e9" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>axis :</span></dt><dd>Z</dd><dt><span>long_name :</span></dt><dd>height</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class="xr-var-data"><pre>array(2.)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">lat</span></div><div class="xr-var-dims">(lat)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-87.86 -85.1 -82.31 ... 85.1 87.86</div><input id="attrs-51bdcd6a-a284-4c80-92b1-53e5df44e29a" class="xr-var-attrs-in" type="checkbox"><label for="attrs-51bdcd6a-a284-4c80-92b1-53e5df44e29a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-88085532-fec2-4e01-a291-502e139d41a3" class="xr-var-data-in" type="checkbox"><label for="data-88085532-fec2-4e01-a291-502e139d41a3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class="xr-var-data"><pre>array([-87.863799, -85.096527, -82.312913, -79.525607, -76.7369  , -73.947515,
       -71.157752, -68.367756, -65.577607, -62.787352, -59.99702 , -57.206632,
       -54.4162  , -51.625734, -48.835241, -46.044727, -43.254195, -40.463648,
       -37.67309 , -34.882521, -32.091944, -29.30136 , -26.510769, -23.720174,
       -20.929574, -18.138971, -15.348365, -12.557756,  -9.767146,  -6.976534,
        -4.185921,  -1.395307,   1.395307,   4.185921,   6.976534,   9.767146,
        12.557756,  15.348365,  18.138971,  20.929574,  23.720174,  26.510769,
        29.30136 ,  32.091944,  34.882521,  37.67309 ,  40.463648,  43.254195,
        46.044727,  48.835241,  51.625734,  54.4162  ,  57.206632,  59.99702 ,
        62.787352,  65.577607,  68.367756,  71.157752,  73.947515,  76.7369  ,
        79.525607,  82.312913,  85.096527,  87.863799])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">lon</span></div><div class="xr-var-dims">(lon)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0 2.812 5.625 ... 354.4 357.2</div><input id="attrs-b207a5f1-b72e-4cc9-9459-3240cf746914" class="xr-var-attrs-in" type="checkbox"><label for="attrs-b207a5f1-b72e-4cc9-9459-3240cf746914" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-32c2b0c7-391e-4f74-ac11-80ac8d670ebd" class="xr-var-data-in" type="checkbox"><label for="data-32c2b0c7-391e-4f74-ac11-80ac8d670ebd" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class="xr-var-data"><pre>array([  0.    ,   2.8125,   5.625 ,   8.4375,  11.25  ,  14.0625,  16.875 ,
        19.6875,  22.5   ,  25.3125,  28.125 ,  30.9375,  33.75  ,  36.5625,
        39.375 ,  42.1875,  45.    ,  47.8125,  50.625 ,  53.4375,  56.25  ,
        59.0625,  61.875 ,  64.6875,  67.5   ,  70.3125,  73.125 ,  75.9375,
        78.75  ,  81.5625,  84.375 ,  87.1875,  90.    ,  92.8125,  95.625 ,
        98.4375, 101.25  , 104.0625, 106.875 , 109.6875, 112.5   , 115.3125,
       118.125 , 120.9375, 123.75  , 126.5625, 129.375 , 132.1875, 135.    ,
       137.8125, 140.625 , 143.4375, 146.25  , 149.0625, 151.875 , 154.6875,
       157.5   , 160.3125, 163.125 , 165.9375, 168.75  , 171.5625, 174.375 ,
       177.1875, 180.    , 182.8125, 185.625 , 188.4375, 191.25  , 194.0625,
       196.875 , 199.6875, 202.5   , 205.3125, 208.125 , 210.9375, 213.75  ,
       216.5625, 219.375 , 222.1875, 225.    , 227.8125, 230.625 , 233.4375,
       236.25  , 239.0625, 241.875 , 244.6875, 247.5   , 250.3125, 253.125 ,
       255.9375, 258.75  , 261.5625, 264.375 , 267.1875, 270.    , 272.8125,
       275.625 , 278.4375, 281.25  , 284.0625, 286.875 , 289.6875, 292.5   ,
       295.3125, 298.125 , 300.9375, 303.75  , 306.5625, 309.375 , 312.1875,
       315.    , 317.8125, 320.625 , 323.4375, 326.25  , 329.0625, 331.875 ,
       334.6875, 337.5   , 340.3125, 343.125 , 345.9375, 348.75  , 351.5625,
       354.375 , 357.1875])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">time</span></div><div class="xr-var-dims">(time)</div><div class="xr-var-dtype">object</div><div class="xr-var-preview xr-preview">1850-01-16 12:00:00 ... 2100-12-...</div><input id="attrs-070e195a-f9b5-48d8-b93b-7a665526d192" class="xr-var-attrs-in" type="checkbox"><label for="attrs-070e195a-f9b5-48d8-b93b-7a665526d192" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9a0a61cd-8814-4695-ac6d-a0e491b59ec2" class="xr-var-data-in" type="checkbox"><label for="data-9a0a61cd-8814-4695-ac6d-a0e491b59ec2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class="xr-var-data"><pre>array([cftime.DatetimeNoLeap(1850, 1, 16, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1850, 2, 15, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1850, 3, 16, 12, 0, 0, 0, has_year_zero=True),
       ...,
       cftime.DatetimeNoLeap(2100, 10, 16, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2100, 11, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2100, 12, 16, 12, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-e926d822-5b13-4cee-aafe-6cdebbdd0522" class="xr-section-summary-in" type="checkbox"><label for="section-e926d822-5b13-4cee-aafe-6cdebbdd0522" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>lat</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-29b12a99-7ff5-4c86-9d90-74685e1f0bb1" class="xr-index-data-in" type="checkbox"><label for="index-29b12a99-7ff5-4c86-9d90-74685e1f0bb1" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([ -87.86379883923273,  -85.09652698831745,  -82.31291294788636,
        -79.52560657265951,   -76.7368996803684,  -73.94751515398974,
        -71.15775201158739,  -68.36775610831324,  -65.57760701082788,
        -62.78735179896313, -59.997020108491355,   -57.2066315276433,
        -54.41619952608627, -51.625733674938296,  -48.83524096625064,
       -46.044726631101724,  -43.25419466535099,  -40.46364817811508,
        -37.67308962904537,   -34.8825209937735, -32.091943881744044,
       -29.301359621762764, -26.510769325211022,  -23.72017393353477,
        -20.92957425448953, -18.138970990239372, -15.348364759491508,
        -12.55775611523069,  -9.767145559195578,  -6.976533553948642,
        -4.185920533189158, -1.3953069108194975,  1.3953069108194975,
         4.185920533189158,   6.976533553948642,   9.767145559195578,
         12.55775611523069,  15.348364759491508,  18.138970990239372,
         20.92957425448953,   23.72017393353477,  26.510769325211022,
        29.301359621762764,  32.091943881744044,    34.8825209937735,
         37.67308962904537,   40.46364817811508,   43.25419466535099,
        46.044726631101724,   48.83524096625064,  51.625733674938296,
         54.41619952608627,    57.2066315276433,  59.997020108491355,
         62.78735179896313,   65.57760701082788,   68.36775610831324,
         71.15775201158739,   73.94751515398974,    76.7368996803684,
         79.52560657265951,   82.31291294788636,   85.09652698831745,
         87.86379883923273],
      dtype='float64', name='lat'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>lon</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-03917769-67fb-4e41-b33e-b4716466651d" class="xr-index-data-in" type="checkbox"><label for="index-03917769-67fb-4e41-b33e-b4716466651d" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([     0.0,   2.8125,    5.625,   8.4375,    11.25,  14.0625,   16.875,
        19.6875,     22.5,  25.3125,
       ...
        331.875, 334.6875,    337.5, 340.3125,  343.125, 345.9375,   348.75,
       351.5625,  354.375, 357.1875],
      dtype='float64', name='lon', length=128))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>time</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-9fa5f1cc-e533-4616-b2de-18a7b371b411" class="xr-index-data-in" type="checkbox"><label for="index-9fa5f1cc-e533-4616-b2de-18a7b371b411" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(CFTimeIndex([1850-01-16 12:00:00, 1850-02-15 00:00:00, 1850-03-16 12:00:00,
             1850-04-16 00:00:00, 1850-05-16 12:00:00, 1850-06-16 00:00:00,
             1850-07-16 12:00:00, 1850-08-16 12:00:00, 1850-09-16 00:00:00,
             1850-10-16 12:00:00,
             ...
             2100-03-16 12:00:00, 2100-04-16 00:00:00, 2100-05-16 12:00:00,
             2100-06-16 00:00:00, 2100-07-16 12:00:00, 2100-08-16 12:00:00,
             2100-09-16 00:00:00, 2100-10-16 12:00:00, 2100-11-16 00:00:00,
             2100-12-16 12:00:00],
            dtype='object', length=3012, calendar='noleap', freq='None'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-56c6cc2e-bf7f-463a-b6cf-395b3fea1ecc" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-56c6cc2e-bf7f-463a-b6cf-395b3fea1ecc" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"></dl></div></li></ul></div></div>
</div>
</div>
</section>
<section id="define-region-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="define-region-of-interest">4. Define region of interest</h3>
<p>CANESM5 SSP 126</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define min/max bounds for region of interest (NEPAL)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lat_min, lat_max <span class="op">=</span> <span class="dv">26</span>, <span class="dv">30</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>lon_min, lon_max <span class="op">=</span> <span class="dv">80</span>, <span class="dv">88</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define logical mask: True when lat/lon inside the valid ranges, False elsewhere</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>tas_lat <span class="op">=</span> (can_tas_126.lat <span class="op">&gt;=</span> lat_min) <span class="op">&amp;</span> (can_tas_126.lat <span class="op">&lt;=</span> lat_max)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>tas_lon <span class="op">=</span> (can_tas_126.lon <span class="op">&gt;=</span> lon_min) <span class="op">&amp;</span> (can_tas_126.lon <span class="op">&lt;=</span> lon_max)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Find points where the mask value is True, drop all other points</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>tas_Nepal_126 <span class="op">=</span> can_tas_126.where(tas_lat <span class="op">&amp;</span> tas_lon, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Average over lat, lon dimensions to get a time series</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate global average</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>can_tas_Nepal_126 <span class="op">=</span> tas_Nepal_126.mean(dim<span class="op">=</span>[<span class="st">"lat"</span>, <span class="st">"lon"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CANESM5 SSP 370</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define logical mask: True when lat/lon inside the valid ranges, False elsewhere</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tas_Nepal_lat <span class="op">=</span> (can_tas_370.lat <span class="op">&gt;=</span> lat_min) <span class="op">&amp;</span> (can_tas_370.lat <span class="op">&lt;=</span> lat_max)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tas_Nepal_lon <span class="op">=</span> (can_tas_370.lon <span class="op">&gt;=</span> lon_min) <span class="op">&amp;</span> (can_tas_370.lon <span class="op">&lt;=</span> lon_max)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find points where the mask value is True, drop all other points</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tas_Nepal_370 <span class="op">=</span> can_tas_370.where(tas_Nepal_lat <span class="op">&amp;</span> tas_Nepal_lon, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Average over lat, lon dimensions to get a time series</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Global Average </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>can_tas_Nepal_370 <span class="op">=</span> tas_Nepal_370.mean(dim<span class="op">=</span>[<span class="st">"lat"</span>, <span class="st">"lon"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CESM SSP 370</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define logical mask: True when lat/lon inside the valid ranges, False elsewhere</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tas_Nepal_lat <span class="op">=</span> (cesm_tas_370.lat <span class="op">&gt;=</span> lat_min) <span class="op">&amp;</span> (cesm_tas_370.lat <span class="op">&lt;=</span> lat_max)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>tas_Nepal_lon <span class="op">=</span> (cesm_tas_370.lon <span class="op">&gt;=</span> lon_min) <span class="op">&amp;</span> (cesm_tas_370.lon <span class="op">&lt;=</span> lon_max)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find points where the mask value is True, drop all other points</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>tas_Nepal_370 <span class="op">=</span> cesm_tas_370.where(tas_Nepal_lat <span class="op">&amp;</span> tas_Nepal_lon, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Average over lat, lon dimensions to get a time series</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Global Average</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>cesm_tas_Nepal_370 <span class="op">=</span> tas_Nepal_370.mean(dim<span class="op">=</span>[<span class="st">"lat"</span>, <span class="st">"lon"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CESM SSP 126</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define logical mask: True when lat/lon inside the valid ranges, False elsewhere</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tas_Nepal_lat <span class="op">=</span> (cesm_tas_126.lat <span class="op">&gt;=</span> lat_min) <span class="op">&amp;</span> (cesm_tas_126.lat <span class="op">&lt;=</span> lat_max)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>tas_Nepal_lon <span class="op">=</span> (cesm_tas_126.lon <span class="op">&gt;=</span> lon_min) <span class="op">&amp;</span> (cesm_tas_126.lon <span class="op">&lt;=</span> lon_max)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find points where the mask value is True, drop all other points</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>tas_Nepal_126 <span class="op">=</span> cesm_tas_126.where(tas_Nepal_lat <span class="op">&amp;</span> tas_Nepal_lon, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Average over lat, lon dimensions to get a time series</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate global average</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>cesm_tas_Nepal_126 <span class="op">=</span> tas_Nepal_126.mean(dim<span class="op">=</span>[<span class="st">"lat"</span>, <span class="st">"lon"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-the-annual-mean-temperature" class="level3">
<h3 class="anchored" data-anchor-id="calculate-the-annual-mean-temperature">5. Calculate the Annual Mean Temperature</h3>
<p>CANESM5</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate annuam mean temperature for all scenarios</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>can_annual_mean_126 <span class="op">=</span> can_tas_Nepal_126.groupby(<span class="st">'time.year'</span>).mean()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>can_annual_mean_370 <span class="op">=</span> can_tas_Nepal_370.groupby(<span class="st">'time.year'</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CESM</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cesm_annual_mean_126 <span class="op">=</span> cesm_tas_Nepal_126.groupby(<span class="st">'time.year'</span>).mean()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cesm_annual_mean_370 <span class="op">=</span> cesm_tas_Nepal_370.groupby(<span class="st">'time.year'</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-weighted-global-temperature-from-two-models-and-two-scenarios" class="level3">
<h3 class="anchored" data-anchor-id="plot-weighted-global-temperature-from-two-models-and-two-scenarios">6. Plot weighted global temperature from two models and two Scenarios</h3>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'seaborn-v0_8-whitegrid'</span>) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>mpl.rcParams.update({<span class="st">'font.size'</span>: <span class="dv">12</span>, <span class="st">'axes.titlesize'</span>: <span class="dv">16</span>, <span class="st">'axes.labelsize'</span>: <span class="dv">14</span>, <span class="st">'xtick.labelsize'</span>: <span class="dv">12</span>, <span class="st">'ytick.labelsize'</span>: <span class="dv">12</span>, <span class="st">'legend.fontsize'</span>: <span class="dv">12</span>})</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.plot(cesm_annual_mean_126.year, cesm_annual_mean_126, label<span class="op">=</span><span class="st">'CESM2, SSP126'</span>, color<span class="op">=</span><span class="st">'#3bceac'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.plot(cesm_annual_mean_370.year, cesm_annual_mean_370, label<span class="op">=</span><span class="st">'CESM2, SSP370'</span>, color<span class="op">=</span><span class="st">'#ee4266'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.plot(can_annual_mean_126.year, can_annual_mean_126, label<span class="op">=</span><span class="st">'CanESM5, SSP126'</span>, color<span class="op">=</span><span class="st">'#ff8811'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.plot(can_annual_mean_370.year, can_annual_mean_370, label<span class="op">=</span><span class="st">'CanESM5, SSP370'</span>, color<span class="op">=</span><span class="st">'#540d6e'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Weighted Regional Mean Temperature (°C)'</span>) </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Nepal Projected Regional Mean Surface Air Temperature Change under Different Scenarios'</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>, frameon<span class="op">=</span><span class="va">True</span>, shadow<span class="op">=</span><span class="va">True</span>) <span class="co"># 'best' tries to find an optimal location</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>) <span class="co"># Make grid lines dashed and slightly transparent</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.gca() <span class="co"># Get current axes</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Ensure layout is tight to prevent labels overlapping</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Display the plot ---</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hw_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="calculate-line-of-best-fit-and-plot-trend-line" class="level3">
<h3 class="anchored" data-anchor-id="calculate-line-of-best-fit-and-plot-trend-line">7. Calculate Line of Best Fit and Plot Trend Line</h3>
<p>Choose CanESM5 Model and SSP 370 scenario</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Fit a trend line for two different time periods</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>model_data <span class="op">=</span> can_annual_mean_370</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>model_label <span class="op">=</span> <span class="st">'CanESM5, SSP370'</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Filter Data for Time Periods ---</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure your data covers these years</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>hist_data <span class="op">=</span> model_data.sel(year<span class="op">=</span><span class="bu">slice</span>(<span class="dv">1850</span>, <span class="dv">2015</span>))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> model_data.sel(year<span class="op">=</span><span class="bu">slice</span>(<span class="dv">1850</span>, <span class="dv">2100</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate best-fit parameters for the linear polynomial fit of temperature to year</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polyfit(hist_data.year, hist_data, <span class="dv">1</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a polynomial object using those best-fit parameters</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>trend_line <span class="op">=</span> np.poly1d(x)  </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polyfit(full_data.year, full_data, <span class="dv">1</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a polynomial object using those best-fit parameters</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>trend_line_full <span class="op">=</span> np.poly1d(y)  </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">7</span>))</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>ax.plot(hist_data.year, hist_data, label<span class="op">=</span> <span class="st">'Historical Annual Avg Temperature of Nepal (1850-2015)'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>ax.plot(hist_data.year, trend_line(hist_data.year), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Historical Trend Line (Slope = </span><span class="sc">{</span>x[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">°C/year)'</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>ax.plot(full_data.year, full_data, label<span class="op">=</span> <span class="st">'Annual Avg Temperature of Nepal (1850-2100)'</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>ax.plot(full_data.year, trend_line_full(full_data.year), color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Full Trend Line (Slope = </span><span class="sc">{</span>y[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">°C/year)'</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'CanESM5, SSP370: Regional Average Surface Air Temp in Nepal (1850 to 2100)'</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Temperature'</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hw_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Fit a trend line for two different time periods</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>model_data <span class="op">=</span> can_annual_mean_126</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>model_label <span class="op">=</span> <span class="st">'CanESM5, SSP126'</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Filter Data for Time Periods ---</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure your data covers these years</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>hist_data <span class="op">=</span> model_data.sel(year<span class="op">=</span><span class="bu">slice</span>(<span class="dv">1850</span>, <span class="dv">2015</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> model_data.sel(year<span class="op">=</span><span class="bu">slice</span>(<span class="dv">1850</span>, <span class="dv">2100</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate best-fit parameters for the linear polynomial fit of temperature to year</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polyfit(hist_data.year, hist_data, <span class="dv">1</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a polynomial object using those best-fit parameters</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>trend_line <span class="op">=</span> np.poly1d(x)  </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polyfit(full_data.year, full_data, <span class="dv">1</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a polynomial object using those best-fit parameters</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>trend_line_full <span class="op">=</span> np.poly1d(y)  </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">7</span>))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ax.plot(hist_data.year, hist_data, label<span class="op">=</span> <span class="st">'Annual Avg Temperature of Nepal (1850-2015)'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>ax.plot(hist_data.year, trend_line(hist_data.year), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Historical Trend Line (Slope = </span><span class="sc">{</span>x[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">°C/year)'</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>ax.plot(full_data.year, full_data, label<span class="op">=</span> <span class="st">'Annual Avg Temperature of Nepal (1850-2100)'</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>ax.plot(full_data.year, trend_line_full(full_data.year), color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Full Trend Line (Slope = </span><span class="sc">{</span>y[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">°C/year)'</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'CanESM5 SSP 126: Regional Average Surface Air Temp in Nepal (1985 to 2100)'</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Temperature'</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hw_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Fit a trend line for two different time periods</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>model_data <span class="op">=</span> cesm_annual_mean_370</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>model_label <span class="op">=</span> <span class="st">'CESM, SSP370'</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2. Filter Data for Time Periods ---</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure your data covers these years</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>hist_data <span class="op">=</span> model_data.sel(year<span class="op">=</span><span class="bu">slice</span>(<span class="dv">1850</span>, <span class="dv">2015</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>full_data <span class="op">=</span> model_data.sel(year<span class="op">=</span><span class="bu">slice</span>(<span class="dv">1850</span>, <span class="dv">2100</span>))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate best-fit parameters for the linear polynomial fit of temperature to year</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.polyfit(hist_data.year, hist_data, <span class="dv">1</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a polynomial object using those best-fit parameters</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>trend_line <span class="op">=</span> np.poly1d(x)  </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.polyfit(full_data.year, full_data, <span class="dv">1</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a polynomial object using those best-fit parameters</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>trend_line_full <span class="op">=</span> np.poly1d(y)  </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">7</span>))</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>ax.plot(hist_data.year, hist_data, label<span class="op">=</span> <span class="st">'Historical Annual Avg Temperature of Nepal'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>ax.plot(hist_data.year, trend_line(hist_data.year), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Historical Trend Line (Slope = </span><span class="sc">{</span>x[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">°C/year)'</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>ax.plot(full_data.year, full_data, label<span class="op">=</span> <span class="st">'Projected Annual Avg Temperature of Nepal'</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>ax.plot(full_data.year, trend_line_full(full_data.year), color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Full Trend Line (Slope = </span><span class="sc">{</span>y[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">°C/year)'</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'CESM SSP370: Regional Average Surface Air Temp in Nepal (1985 to 2100)'</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Temperature'</span>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hw_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="compare-change-between-best-fit-line" class="level3">
<h3 class="anchored" data-anchor-id="compare-change-between-best-fit-line">8. Compare change between best fit line</h3>
<div class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For historical period (1850-2015)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>slope1, intercept1, r_value1, p_value1, stderr1 <span class="op">=</span> stats.linregress(hist_data.year.values, hist_data.values)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For full period (1850-2100)</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>slope2, intercept2, r_value2, p_value2, stderr2 <span class="op">=</span> stats.linregress(full_data.year.values, full_data.values)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Historical Slope (1850-2015): </span><span class="sc">{</span>slope1<span class="sc">:.4f}</span><span class="ss">, Standard Error: </span><span class="sc">{</span>stderr1<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Full Period Slope (1850-2100): </span><span class="sc">{</span>slope2<span class="sc">:.4f}</span><span class="ss">, Standard Error: </span><span class="sc">{</span>stderr2<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Test the difference between slopes (with caveats about non-independence) ---</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the difference in slopes</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>slope_diff <span class="op">=</span> slope1 <span class="op">-</span> slope2</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the pooled standard error for the difference</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This formula assumes independence, which is violated here.</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>pooled_stderr <span class="op">=</span> np.sqrt(stderr1<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> stderr2<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Z-statistic</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Avoid division by zero if pooled_stderr is extremely small</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> pooled_stderr <span class="op">&gt;</span> <span class="fl">1e-9</span>:</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    z_stat <span class="op">=</span> slope_diff <span class="op">/</span> pooled_stderr</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the two-tailed p-value from the Z-statistic</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    p_value_diff <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> stats.norm.cdf(<span class="bu">abs</span>(z_stat)))</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    z_stat <span class="op">=</span> np.inf <span class="co"># Or some indicator of an issue</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    p_value_diff <span class="op">=</span> <span class="fl">0.0</span> <span class="co"># If slopes are identical and errors are zero</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">--- Comparison of Slopes ---"</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Difference in slopes: </span><span class="sc">{</span>slope_diff<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Z-statistic: </span><span class="sc">{</span>z_stat<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value for difference: </span><span class="sc">{</span>p_value_diff<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Interpretation ---</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># Significance level</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_diff <span class="op">&lt;</span> alpha:</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Result: The difference between the slopes is statistically significant at alpha=</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> (p=</span><span class="sc">{</span>p_value_diff<span class="sc">:.4f}</span><span class="ss">)."</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Result: The difference between the slopes is not statistically significant at alpha=</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss"> (p=</span><span class="sc">{</span>p_value_diff<span class="sc">:.4f}</span><span class="ss">)."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Historical Slope (1850-2015): 0.0029, Standard Error: 0.0010
Full Period Slope (1850-2100): 0.0226, Standard Error: 0.0011

--- Comparison of Slopes ---
Difference in slopes: -0.0197
Z-statistic: -13.3396
P-value for difference: 0.0000

Result: The difference between the slopes is statistically significant at alpha=0.05 (p=0.0000).</code></pre>
</div>
</div>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<ol start="3" type="1">
<li>a: Describe, in markdown text, the climate of that region in general terms. What is it like? Is it a forest, a desert, polar, tropical,urban, etc? What types of climate change impacts might you expect there?</li>
</ol>
<ul>
<li>Nepal’s climate is highly diverse due to its varied topography, ranging from the lowlands of the Terai to the high Himalayas. It experiences a monsoon-influenced climate with distinct seasons, including a hot, dry pre-monsoon summer, a warm and humid monsoon with heavy rainfall, a mild post-monsoon autumn, and a cold, dry winter with snowfall in mountainous regions. The landscape transitions from tropical and subtropical zones in the southern Terai, characterized by hot, humid conditions and fertile plains, to temperate zones in the mid-hills with moderate climates and terraced farmland, and finally to alpine zones in the high Himalayas, marked by harsh cold, glaciers, and sparse vegetation. Climate change poses significant challenges, including rising temperatures that accelerate glacial melt, altered ecosystems, and potential heatwaves, along with erratic precipitation patterns that heighten risks of floods, landslides, and droughts, as well as glacial lake outburst floods (GLOFs), threatening long-term water availability.</li>
</ul>
<ol start="4" type="1">
<li>Over both of those time periods, is the temperature of your region changing, and is that change statistically significant?</li>
</ol>
<ul>
<li>The region exhibits a statistically significant warming trend over both the historical period (1850–2015) and the full period (1850–2100) for both models. While linear trend lines may not perfectly capture the complex, non-linear nature of climate change, they provide a standardized method for assessing the overall rate of change. This allows for a straightforward comparison of the steepness of trends (slopes) between different time periods, such as historical data versus future projections, to understand shifts in the rate of warming or other climate variables. For CESM2, the historical warming rate has a slope of 0.0029 and the full period, including future projections under the SSP370 scenario, shows a steeper slope of 0.0226, indicating accelerated warming. The statistical significance of these trends is supported by the slopes being substantially larger than their respective standard errors, and the difference between the historical and full-period warming rates is confirmed as statistically significant (p &lt; 0.01), highlighting a much faster rate of temperature increase when future projections are included.</li>
</ul>
<ol start="5" type="1">
<li>Write 1-2 paragraphs in markdown text describing the results of your plot, and what you think they might mean for humans or ecosystems located in your study region.</li>
</ol>
<ul>
<li><p>The analysis comparing historical (1850-2015) and projected future temperature trends for Nepal reveals a clear and statistically significant acceleration of warming across all examined scenarios and models. Both the CanESM5 and CESM2 climate models show that the rate of warming projected for the 21st century under both the low-emissions SSP126 and the medium-to-high emissions SSP370 scenarios is significantly steeper than the trend observed during the historical period. This indicates that the warming Nepal has already experienced is expected to intensify considerably in the coming decades. While both future scenarios depict accelerated warming compared to the past, the magnitude of this acceleration is substantially greater under the SSP370 scenario in both models, leading to a much faster temperature increase and a significantly warmer end-of-century outcome compared to the SSP126 pathway.</p></li>
<li><p>The consistency between CanESM5 and CESM2 in projecting this accelerated warming relative to the historical baseline strengthens confidence in these findings. For Nepal, this means that the environmental and societal challenges associated with rising temperatures are set to escalate. Compared to historical conditions, future Nepal under either scenario faces amplified risks related to glacial melt and water resource variability, shifts in agricultural zones, altered monsoon dynamics, and increased stress on its unique mountain ecosystems. However, the severity of these impacts diverges sharply between the scenarios: the SSP370 pathway points towards far more drastic and potentially unmanageable changes compared to the historical baseline and the SSP126 scenario, emphasizing the critical difference global mitigation efforts make for Nepal’s future climate and the adaptation burden it will face.</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>